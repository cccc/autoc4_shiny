var A=Object.defineProperty;var w=(a,t,e)=>t in a?A(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var u=(a,t,e)=>w(a,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();$("body").on("click input change","[data-toggle=value][data-target][data-value],[data-toggle=value][href][data-value]",function(){for(const a of document.querySelectorAll(this.getAttribute("data-target")||this.getAttribute("href")))a.value=this.getAttribute("data-value")||""});$("body").on("click input change","[data-toggle=display][data-target],[data-toggle=display][href]",function(){for(const a of document.querySelectorAll(this.getAttribute("data-target")||this.getAttribute("href")))a.classList.toggle("d-none")});/**
 * @description A simple script adding a "dark" class to the body
 * if certain conditions are met. Can be used for creating a dark
 * mode based on SearchParams, LocalStorage, and the browsers prefered
 * color scheme.
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2019-2020
 * @license MIT
 */((a,t)=>{const e=t("body"),s=a.matchMedia("(prefers-color-scheme: dark)"),o="DARK_THEME_ENABLED";function n(l){s.matches?(e.addClass("dark"),e.removeClass("light")):a.matchMedia("(prefers-color-scheme: light)").matches&&(e.addClass("light"),e.removeClass("dark")),l&&s.addEventListener("change",r)}function i(){s.removeEventListener("change",r)}const r=n.bind(null,!1);try{const l=new URLSearchParams(a.location.search);l.has("dark")||l.has("light")?l.has("dark")?(localStorage.setItem(o,"true"),e.addClass("dark"),e.removeClass("light")):l.get("light")&&(localStorage.setItem(o,"false"),e.addClass("light"),e.removeClass("dark")):localStorage.getItem(o)!==null?localStorage.getItem(o)==="true"?(e.addClass("dark"),e.removeClass("light")):(e.addClass("light"),e.removeClass("dark")):n(!0)}catch{n(!0)}t(()=>{e.on("click","[data-toggle=theme]",l=>{l.preventDefault();try{localStorage.setItem("DARK_THEME_ENABLED",localStorage.getItem("DARK_THEME_ENABLED")==="true"?"false":"true"),e.toggleClass("dark"),e.toggleClass("light"),i()}catch{const c=new URLSearchParams(a.location.search);e.hasClass("dark")?(c.delete("dark"),c.set("light","")):(c.delete("light"),c.set("dark","")),a.location.search=c.toString()}})})})(window,jQuery);/**
 * @description A joke module which activates the cyber mode when
 * a certain key sequence is pressed or a certain topic gets activated.
 * This is primarily intended to react to the Konami Code and the cyber
 * alert topic but can in theory add any class to any element upon
 * activation of any topic.
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2019-2020
 * @license MIT
 */let _=class{constructor(t,e){u(this,"options");if(this.options=e,this.options.keys){let s=0;document.addEventListener("keydown",o=>{s=o.keyCode===this.options.keys[s]?s+1:0,s===this.options.keys.length&&(this.toggle(),s=0)})}}toggle(t){const e=document.querySelectorAll(this.options.target);for(const s of e)s.classList.toggle(this.options.class,t)}onMessage(t,e){e.payloadBytes[0]?this.toggle(!0):this.toggle(!1)}};function C(a,t){return new _(a,t)}/**
 * @description A simple module defining a utility class for simple RGB/HSV color conversion
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2019-2020
 * @license MIT
 */class f{constructor(){u(this,"_h");u(this,"_s");u(this,"_v");u(this,"_r");u(this,"_g");u(this,"_b");this.rgb={r:0,g:0,b:0}}get h(){return this._h}set h(t){this._h=t,this.updateRGB()}get s(){return this._s}set s(t){this._s=t,this.updateRGB()}get v(){return this._v}set v(t){this._v=t,this.updateRGB()}get hsv(){return{h:this._h,s:this._s,v:this._v}}set hsv(t){this._h=t.h,this._s=t.s,this._v=t.v,this.updateRGB()}get r(){return this._r}set r(t){this._r=t,this.updateHSV()}get g(){return this._g}set g(t){this._g=t,this.updateHSV()}get b(){return this._b}set b(t){this._b=t,this.updateHSV()}get rgb(){return{r:this._r,g:this._g,b:this._b}}set rgb(t){this._r=t.r,this._g=t.g,this._b=t.b,this.updateHSV()}updateHSV(){const t=f.RGBtoHSV(this.rgb);this._h=t.h,this._s=t.s,this._v=t.v}updateRGB(){const t=f.HSVtoRGB(this.hsv);this._r=t.r,this._g=t.g,this._b=t.b}static RGBtoHSV(t){const e=t.g,s=t.b,o=t.r,n=Math.max(o,e,s),i=Math.min(o,e,s),r=n-i;let l;const c=n===0?0:r/n,h=n/255;switch(n){case i:l=0;break;case o:l=e-s+r*(e<s?6:0),l/=6*r;break;case e:l=s-o+r*2,l/=6*r;break;case s:l=o-e+r*4,l/=6*r;break}return{h:l,s:c,v:h}}static HSVtoRGB(t){let e,s,o,n,i,r,l,c;const h=t.h,p=t.s,d=t.v;switch(n=Math.floor(h*6),i=h*6-n,r=d*(1-p),l=d*(1-i*p),c=d*(1-(1-i)*p),n%6){case 0:e=d,s=c,o=r;break;case 1:e=l,s=d,o=r;break;case 2:e=r,s=d,o=c;break;case 3:e=r,s=l,o=d;break;case 4:e=c,s=r,o=d;break;case 5:e=d,s=r,o=l;break}return{r:Math.round(e*255),g:Math.round(s*255),b:Math.round(o*255)}}toHexString(){return`#${f.numberToHexString(this._r)}${f.numberToHexString(this._g)}${f.numberToHexString(this._b)}`}static fromRGB(t){const e=new f;return e.rgb=t,e}static fromHSV(t){const e=new f;return e.hsv=t,e}static fromHexString(t){const e=new f;return e.rgb={r:Number.parseInt(t.substring(1,3),16),g:Number.parseInt(t.substring(3,5),16),b:Number.parseInt(t.substring(5,7),16)},e}static numberToHexString(t,e=2){let s=t.toString(16);return s="0".repeat(e-s.length)+s,s}}/**
 * @description A module that allows controlling DMX/RGB lights
 * controlled through AutoC4. It supports 3/4 and 7 channel
 * DMX lights.
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 * @requires color
 */let M=class{constructor(t,e){u(this,"options");u(this,"autoc4");this.options=e,this.autoc4=t,this.initColorSelection(),this.initPoweroff(),this.initBrightness(),this.initFade(),this.initRandom(),this.initSound()}onMessage(t,e){const s=e.destinationName.split("/");if(s.length<3)return;const o=e.payloadBytes;if(o.length<3)return;const n=s[1],i=s[2],r=this.getPickers(n,"light",i);if(!r.length)return;const l=f.fromRGB({r:o[0],g:o[1],b:o[2]}).toHexString();for(const c of r)c.value=l;this.updateMasterForRoom(n)}updateMasterForRoom(t){let e;for(const s of this.getPickers(t))e===void 0?e=s.value:e!=s.value&&(e="#000000");for(const s of this.getPickers(t,"master"))s.value=e}initColorSelection(){const t=this;$("body").on("change",`[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=light],[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=master]`,function(){const e=f.fromHexString(this.value),s=+this.getAttribute(t.options.channelsDataAttribute)||7,o=this.getAttribute(t.options.roomDataAttribute);let n=this.getAttribute(t.options.lightDataAttribute);if(!n)if(this.getAttribute(t.options.roleDataAttribute)==="master")n="master";else return;t.setLightColor(o,n,s,e)})}initPoweroff(){const t=this;$("body").on("click change",`[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=poweroff]`,function(){const e=f.fromRGB({r:0,g:0,b:0}),s=+this.getAttribute(t.options.channelsDataAttribute)||7,o=this.getAttribute(t.options.roomDataAttribute);let n=this.getAttribute(t.options.lightDataAttribute);n||(n="master"),t.setLightColor(o,n,s,e)})}initBrightness(){const t=this;$("body").on("click change",`[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=brightness][${this.options.valueDataAttribute}]`,function(){const e=+this.getAttribute(t.options.valueDataAttribute),s=this.getAttribute(t.options.roomDataAttribute);for(const o of t.getPickers(s)){const n=+o.getAttribute(t.options.channelsDataAttribute)||7,i=o.getAttribute(t.options.lightDataAttribute),r=f.fromHexString(o.value);r.v=Math.min(Math.max(0,r.v*e),1),t.setLightColor(s,i,n,r)}})}initRandom(){const t=this;$("body").on("click change",`[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=random][${this.options.valueDataAttribute}]`,function(){const e=+$(this.getAttribute(t.options.valueDataAttribute)).val(),s=$(this.getAttribute(t.options.roomDataAttribute)).val();for(const o of t.getPickers(s)){const n=+o.getAttribute(t.options.channelsDataAttribute)||7,i=o.getAttribute(t.options.lightDataAttribute),r=f.fromHSV({h:Math.random(),s:1,v:e});t.setLightColor(s,i,n,r)}})}initFade(){const t=this;$("body").on("click change",`[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=fade][${this.options.valueDataAttribute}]`,function(){const e=+$(this.getAttribute(t.options.valueDataAttribute)).val(),s=$(this.getAttribute(t.options.roomDataAttribute)).val();for(const o of t.getPickers(s)){if((+o.getAttribute(t.options.channelsDataAttribute)||7)!=7)continue;const i=o.getAttribute(t.options.lightDataAttribute);t.sendLightData(s,i,new Uint8Array([0,0,0,0,e,140,255]))}})}initSound(){const t=this;$("body").on("click change",`[${this.options.roomDataAttribute}][${this.options.roleDataAttribute}=sound][${this.options.valueDataAttribute}]`,function(){const e=+$(this.getAttribute(t.options.valueDataAttribute)).val(),s=$(this.getAttribute(t.options.roomDataAttribute)).val();for(const o of t.getPickers(s)){if((+o.getAttribute(t.options.channelsDataAttribute)||7)!=7)continue;const i=o.getAttribute(t.options.lightDataAttribute);t.sendLightData(s,i,new Uint8Array([0,0,0,0,e,246,255]))}})}setLightColor(t,e,s,o){s==3?this.sendLightData(t,e,new Uint8Array([o.r,o.g,o.b,255])):this.sendLightData(t,e,new Uint8Array([o.r,o.g,o.b,0,0,0,255]))}sendLightData(t,e,s){this.autoc4.sendData(`dmx/${t}/${e}`,s,!0),this.updateMasterForRoom(t)}getPickers(t,e="light",s){let o;return s===void 0?o=document.querySelectorAll(`[${this.options.roleDataAttribute}="${e}"][${this.options.roomDataAttribute}="${t}"]`):o=document.querySelectorAll(`[${this.options.roleDataAttribute}="${e}"][${this.options.roomDataAttribute}="${t}"][${this.options.lightDataAttribute}="${s}"]`),Array.prototype.slice.apply(o)}};function D(a,t){return new M(a,t)}/**
 * @description This module looks for the actication of a range of topics and adds them
 * into a list monitoring the activation/deactivation and displaying the current state.
 * This primarily used for monitoring the state of infrastructure(running/dead) that is
 * part of AutoC4.
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let S=class{constructor(){u(this,"heartbeats",{})}onMessage(t,e){const s=e.destinationName.substring(10);s in this.heartbeats||(this.heartbeats[s]=this.createEntry(s),$("#infrastructure-table").append(this.heartbeats[s].element)),e.payloadBytes.length||(this.heartbeats[s].element.remove(),delete this.heartbeats[s]),e.payloadBytes[0]?this.heartbeats[s].state_icon.addClass("fa-thumbs-up").removeClass("fa-thumbs-down"):this.heartbeats[s].state_icon.addClass("fa-thumbs-down").removeClass("fa-thumbs-up")}createEntry(t){const e={element:$("<tr>").append($("<td>").addClass("heartbeat-name").text(t)),state_icon:$("<i>").addClass("heartbeat-state-icon fa").attr("data-heartbeat-name",t)};return e.element.append($("<td>").addClass("heartbeat-state").append(e.state_icon)),e}};function T(a,t){return new S}/**
 * @description A simple module for defining data attributes for elements
 * such that when there is any user interaction with the element an MQTT
 * message is sent.
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2019-2020
 * @license MIT
 */let x=class{constructor(t,e){u(this,"autoc4");u(this,"options");this.options=e,this.autoc4=t;const s=this;$("body").on("click change input",`[${this.options.mqttTopicDataAttibute}]`,function(o){o.preventDefault();const n=this.getAttribute(s.options.mqttTopicDataAttibute);if(!n)return;const i=!!this.getAttribute(s.options.mqttRetainedDataAttribute);this.hasAttribute(s.options.mqttMessageDataAttribute)?s.autoc4.sendData(n,this.getAttribute(s.options.mqttMessageDataAttribute),i):this.hasAttribute(s.options.mqttByteMessageDataAttribute)?s.autoc4.sendByte(n,Number(this.getAttribute(s.options.mqttByteMessageDataAttribute)),i):s.autoc4.sendByte(n,0,i)})}};function L(a,t){return new x(a,t)}/**
 * @description The code below is cursed. Look at it at your own risk.
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let N=class{constructor(t,e){u(this,"autoc4");this.autoc4=t,$("#klMatrixLines").on("input",function(){$("#klMatrixLinesOut").val(Number.parseInt(this.value))}),$("#klConwaySpeed").on("input",function(){$("#klConwaySpeedOut").val(Number.parseInt(this.value))}),$("#klConwayGenerations").on("input",function(){$("#klConwayGenerationsOut").val(Number.parseInt(this.value))}),$("#klSelect").change(function(){$(".klPane.active").removeClass("active"),$(`#${this.value}`).addClass("active")}),$("#klSet").click(()=>{switch($("#klSelect").val()){case"klEmpty":this.kl_empty();break;case"klChecker":this.kl_checker(Number.parseInt($("#klCheckerDelay").val()),$("#klCheckerColorA").val(),$("#klCheckerColorB").val());break;case"klPacman":this.kl_pacman();break;case"klText":this.kl_text(Number.parseInt($("#klTextDelay").val()),$("#klTextText").val());break;case"klOpenChaos":this.kl_open_chaos(Number.parseInt($("#klOCDelay").val()));break;case"klMatrix":this.kl_matrix(Number.parseInt($("#klMatrixLines").val()));break;case"klMood":this.kl_moodlight(Number.parseInt($("#klMoodMode").val()));break;case"klSine":this.kl_sine();break;case"klStrobe":this.kl_strobe();break;case"klFlood":this.kl_flood();break;case"klClock":this.kl_clock();break;case"klConway":this.kl_conway(Number.parseInt($("#klConwaySpeed").val()),Number.parseInt($("#klConwayGenerations").val()),$("#klConwayFill")[0].checked);break}}),$(".klPane.active").removeClass("active"),$(`#${$("#klSelect").val()}`).addClass("active"),$(".btn-floodit").click(function(){const s=this.textContent;if(!s)return;const o=Number.parseInt(s)-1;t.sendByte("kitchenlight/FloodIt/flood",o,!0)}),$("#klFlood").keypress(s=>{s.which<49||s.which>56||($(`#klFlood${s.which-48}`).click(),s.preventDefault())})}kl_change_screen(t){this.autoc4.sendData("kitchenlight/change_screen",t,!0)}kl_empty(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,0,!0),this.kl_change_screen(t)}kl_checker(t,e,s){const o=new ArrayBuffer(20),n=new DataView(o);n.setUint32(0,1,!0),n.setUint32(4,t,!0),n.setUint16(8,Number.parseInt(e.substr(1,2),16)*1023/255,!0),n.setUint16(10,Number.parseInt(e.substr(3,2),16)*1023/255,!0),n.setUint16(12,Number.parseInt(e.substr(5,2),16)*1023/255,!0),n.setUint16(14,Number.parseInt(s.substr(1,2),16)*1023/255,!0),n.setUint16(16,Number.parseInt(s.substr(3,2),16)*1023/255,!0),n.setUint16(18,Number.parseInt(s.substr(5,2),16)*1023/255,!0),this.kl_change_screen(o)}kl_matrix(t){const e=new ArrayBuffer(8),s=new DataView(e);s.setUint32(0,2,!0),s.setUint32(4,t,!0),this.kl_change_screen(e)}kl_moodlight(t){let e,s;t===1?(e=new ArrayBuffer(19),s=new DataView(e),s.setUint32(0,3,!0),s.setUint8(4,t),s.setUint32(5,1,!0),s.setUint32(9,10,!0),s.setUint32(13,1e4,!0),s.setUint16(17,30,!0),this.kl_change_screen(e)):(e=new ArrayBuffer(17),s=new DataView(e),s.setUint32(0,3,!0),s.setUint8(4,t),s.setUint32(5,1,!0),s.setUint32(9,10,!0),s.setUint32(13,1e4,!0),this.kl_change_screen(e))}kl_open_chaos(t){const e=new ArrayBuffer(8),s=new DataView(e);s.setUint32(0,4,!0),s.setUint32(4,t,!0),this.kl_change_screen(e)}kl_pacman(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,5,!0),this.kl_change_screen(t)}kl_sine(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,6,!0),this.kl_change_screen(t)}kl_strobe(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,7,!0),this.kl_change_screen(t)}kl_text(t,e){const s=new ArrayBuffer(8+e.length+1),o=new DataView(s);o.setUint32(0,8,!0),o.setUint32(4,t,!0);for(let n=0;n<e.length;n+=1)o.setUint8(8+n,e.charCodeAt(n)&255);o.setUint8(8+e.length,0),this.kl_change_screen(s)}kl_flood(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,9,!0),this.kl_change_screen(t)}kl_clock(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,11,!0),this.kl_change_screen(t)}kl_conway(t,e,s){const o=new ArrayBuffer(16),n=new DataView(o);n.setUint32(0,12,!0),n.setUint32(4,t,!0),n.setUint32(8,e,!0),s?n.setUint32(12,1,!0):n.setUint32(12,0,!0),this.kl_change_screen(o)}};function B(a,t){return new N(a,t)}/**
 * @description A module to provide simple toggle buttons for topics
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let E=class{constructor(t,e){u(this,"autoc4");u(this,"options");this.autoc4=t,this.options=e,this.initLightButtons()}initLightButtons(){const t=this;$("body").on("click",`[${this.options.topicDataAttribute}]`,function(){t.autoc4.sendByte(this.getAttribute(t.options.topicDataAttribute),this.classList.contains(t.options.onClass)?0:1,!0)})}onMessage(t,e){const s=$(`[${this.options.topicDataAttribute}="${e.destinationName}"]`);s&&e.payloadBytes[0]!==0?s.addClass(this.options.onClass):s.removeClass(this.options.onClass)}};function U(a,t){return new E(a,t)}/**
 * @description A simple module to add support for MPD bridge states
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let I=class{constructor(t,e){u(this,"options");this.options=e}onMessage(t,e){let s=document.querySelectorAll(`[${this.options.roleDataAttribute}=state][${this.options.topicDataAttribute}="${e.destinationName}"]`);for(const o of s)e.payloadString==="play"?(o.classList.add(this.options.playingClass),o.classList.remove(this.options.pausedClass,this.options.stoppedClass)):e.payloadString==="pause"?(o.classList.add(this.options.pausedClass),o.classList.remove(this.options.playingClass,this.options.stoppedClass)):e.payloadString==="stop"&&(o.classList.add(this.options.stoppedClass),o.classList.remove(this.options.playingClass,this.options.pausedClass));s=document.querySelectorAll(`[${this.options.roleDataAttribute}=song][${this.options.topicDataAttribute}="${e.destinationName}"]`);for(const o of s)o.innerText=e.payloadString}};function H(a,t){return new I(a,t)}var P=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function O(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var v={exports:{}};/*!
 * Toastify js 1.12.0
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */(function(a){(function(t,e){a.exports?a.exports=e():t.Toastify=e()})(P,function(t){var e=function(i){return new e.lib.init(i)},s="1.12.0";e.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},e.lib=e.prototype={toastify:s,constructor:e,init:function(i){return i||(i={}),this.options={},this.toastElement=null,this.options.text=i.text||e.defaults.text,this.options.node=i.node||e.defaults.node,this.options.duration=i.duration===0?0:i.duration||e.defaults.duration,this.options.selector=i.selector||e.defaults.selector,this.options.callback=i.callback||e.defaults.callback,this.options.destination=i.destination||e.defaults.destination,this.options.newWindow=i.newWindow||e.defaults.newWindow,this.options.close=i.close||e.defaults.close,this.options.gravity=i.gravity==="bottom"?"toastify-bottom":e.defaults.gravity,this.options.positionLeft=i.positionLeft||e.defaults.positionLeft,this.options.position=i.position||e.defaults.position,this.options.backgroundColor=i.backgroundColor||e.defaults.backgroundColor,this.options.avatar=i.avatar||e.defaults.avatar,this.options.className=i.className||e.defaults.className,this.options.stopOnFocus=i.stopOnFocus===void 0?e.defaults.stopOnFocus:i.stopOnFocus,this.options.onClick=i.onClick||e.defaults.onClick,this.options.offset=i.offset||e.defaults.offset,this.options.escapeMarkup=i.escapeMarkup!==void 0?i.escapeMarkup:e.defaults.escapeMarkup,this.options.ariaLive=i.ariaLive||e.defaults.ariaLive,this.options.style=i.style||e.defaults.style,i.backgroundColor&&(this.options.style.background=i.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var i=document.createElement("div");i.className="toastify on "+this.options.className,this.options.position?i.className+=" toastify-"+this.options.position:this.options.positionLeft===!0?(i.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):i.className+=" toastify-right",i.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.');for(var r in this.options.style)i.style[r]=this.options.style[r];if(this.options.ariaLive&&i.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)i.appendChild(this.options.node);else if(this.options.escapeMarkup?i.innerText=this.options.text:i.innerHTML=this.options.text,this.options.avatar!==""){var l=document.createElement("img");l.src=this.options.avatar,l.className="toastify-avatar",this.options.position=="left"||this.options.positionLeft===!0?i.appendChild(l):i.insertAdjacentElement("afterbegin",l)}if(this.options.close===!0){var c=document.createElement("button");c.type="button",c.setAttribute("aria-label","Close"),c.className="toast-close",c.innerHTML="&#10006;",c.addEventListener("click",(function(b){b.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}).bind(this));var h=window.innerWidth>0?window.innerWidth:screen.width;(this.options.position=="left"||this.options.positionLeft===!0)&&h>360?i.insertAdjacentElement("afterbegin",c):i.appendChild(c)}if(this.options.stopOnFocus&&this.options.duration>0){var p=this;i.addEventListener("mouseover",function(b){window.clearTimeout(i.timeOutValue)}),i.addEventListener("mouseleave",function(){i.timeOutValue=window.setTimeout(function(){p.removeElement(i)},p.options.duration)})}if(typeof this.options.destination<"u"&&i.addEventListener("click",(function(b){b.stopPropagation(),this.options.newWindow===!0?window.open(this.options.destination,"_blank"):window.location=this.options.destination}).bind(this)),typeof this.options.onClick=="function"&&typeof this.options.destination>"u"&&i.addEventListener("click",(function(b){b.stopPropagation(),this.options.onClick()}).bind(this)),typeof this.options.offset=="object"){var d=o("x",this.options),g=o("y",this.options),y=this.options.position=="left"?d:"-"+d,k=this.options.gravity=="toastify-top"?g:"-"+g;i.style.transform="translate("+y+","+k+")"}return i},showToast:function(){this.toastElement=this.buildToast();var i;if(typeof this.options.selector=="string"?i=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||typeof ShadowRoot<"u"&&this.options.selector instanceof ShadowRoot?i=this.options.selector:i=document.body,!i)throw"Root element is not defined";var r=e.defaults.oldestFirst?i.firstChild:i.lastChild;return i.insertBefore(this.toastElement,r),e.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((function(){this.removeElement(this.toastElement)}).bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(i){i.className=i.className.replace(" on",""),window.setTimeout((function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),i.parentNode&&i.parentNode.removeChild(i),this.options.callback.call(i),e.reposition()}).bind(this),400)}},e.reposition=function(){for(var i={top:15,bottom:15},r={top:15,bottom:15},l={top:15,bottom:15},c=document.getElementsByClassName("toastify"),h,p=0;p<c.length;p++){n(c[p],"toastify-top")===!0?h="toastify-top":h="toastify-bottom";var d=c[p].offsetHeight;h=h.substr(9,h.length-1);var g=15,y=window.innerWidth>0?window.innerWidth:screen.width;y<=360?(c[p].style[h]=l[h]+"px",l[h]+=d+g):n(c[p],"toastify-left")===!0?(c[p].style[h]=i[h]+"px",i[h]+=d+g):(c[p].style[h]=r[h]+"px",r[h]+=d+g)}return this};function o(i,r){return r.offset[i]?isNaN(r.offset[i])?r.offset[i]:r.offset[i]+"px":"0px"}function n(i,r){return!i||typeof r!="string"?!1:!!(i.className&&i.className.trim().split(/\s+/gi).indexOf(r)>-1)}return e.lib.init.prototype=e.lib,e})})(v);var V=v.exports;const R=O(V);/**
 * @description A simple module for defining data attributes for elements
 * such that when there is any user interaction with the element an MQTT
 * message is sent.
 * @author Qb
 * @copyright Chaos Computer Club Cologne 2019-2024
 * @license MIT
 */let F=class{constructor(t,e){u(this,"options");this.options=e}onMessage(t,e){const s=e.payloadString;let o=this.options.textTemplate;this.options.payloadStringPlaceholder&&(o=o.split(this.options.payloadStringPlaceholder).join(s)),R({text:o,duration:this.options.hideDelayMs,gravity:"bottom",position:"center",style:{border:"2px solid #888",borderRadius:"6px",background:"inherit",color:"inherit",boxShadow:"none"}}).showToast()}};function q(a,t){return new F(a,t)}/**
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let G=class{constructor(t,e){$("body").on("click",`[${e.topicDataAttribute}]`,function(){const s=$(this);t.sendData(s.attr(`[${e.topicDataAttribute}]`),s.attr("data-preset-message")||"")})}create_button(t,e){return $("<button>",{type:"button",class:"btn btn-preset","data-preset-topic":t==="global"?"preset/set":`preset/${t}/set`,"data-preset-message":e}).text(e)}onMessage(t,e){let s;try{s=JSON.parse(e.payloadString)}catch{console.log("module/presets: Invalid JSON received");return}let o=e.destinationName.split("/")[1];if(o==="list"){o="global";for(const i of document.querySelectorAll("div.preset-pane[data-room]")){const r=i.querySelector(".preset-pane-global-marker");if(!r){console.warn("module/presets: No global marker found for preset pane",i);continue}const l=i.getAttribute("data-room");for(const c of s)this.create_button(l,c).insertBefore(r)}}const n=document.querySelector(`div.preset-pane[data-room="${o}"] > .preset-pane-room-marker`);if(!n){console.warn(`module/presets: No room marker found for room: ${o}`);return}for(const i of s)this.create_button(o,i).insertBefore(n)}onConnect(t,e){$("div.preset-pane[data-room] > [data-preset-topic]").remove()}};function j(a,t){return new G(a,t)}/**
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let Q=class{constructor(t,e){u(this,"options");this.options=e}onMessage(t,e){const s=document.querySelectorAll(this.options.target);e.payloadBytes[0]?s.forEach(o=>{o.classList.remove(this.options.closedClass,this.options.disconnectedClass),o.classList.add(this.options.openClass)}):s.forEach(o=>{o.classList.remove(this.options.openClass,this.options.disconnectedClass),o.classList.add(this.options.closedClass)})}onConnectionFailure(t,e){document.querySelectorAll(this.options.target).forEach(s=>{s.classList.remove(this.options.openClass,this.options.closedClass),s.classList.add(this.options.disconnectedClass)})}};function W(a,t){return new Q(a,t)}/**
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */function z(a,t){const e=a.split("/"),s=t.split("/");for(let o=0;o<e.length;o++){const n=e[o];if(n==="#")return!0;if(n!==s[o]&&n!=="+")return!1}return e.length===s.length}function m(a){return`0${a}`.slice(-2)}function K(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const t=Math.random()*16|0;return(a==="x"?t:t&3|8).toString(16)})}function Y(a,t){return a.replace(/yyyy/,t.getFullYear().toString()).replace(/yy/,(t.getFullYear()%100).toString()).replace(/MM/,m(t.getMonth()+1)).replace(/M/,(t.getMonth()+1).toString()).replace(/dd/,m(t.getDate())).replace(/d/,t.getDate().toString()).replace(/HH/,m(t.getHours())).replace(/H/,t.getHours().toString()).replace(/mm/,m(t.getMinutes())).replace(/m/,t.getMinutes().toString()).replace(/ss/,m(t.getSeconds())).replace(/s/,t.getSeconds().toString())}/**
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */let J=class{constructor(t,e){u(this,"options");this.options=e,this.options.defaultToCurrentTime&&this.setTime(new Date)}onMessage(t,e){if(e.payloadBytes.byteLength<7){console.warn(`Received invalid time payload on topic "${e.destinationName}".`);return}const s=e.payloadBytes,o=new Date,n=new Date(o.getFullYear()-o.getFullYear()%100+s[7],s[5]-1,s[6],s[0],s[1],s[2]);this.setTime(n)}setTime(t){const e=document.querySelectorAll(this.options.targetSelector);for(const s of e)s.textContent=Y(s.getAttribute(this.options.templateDataAttribute)||"yyyy-MM-ddZHH-mm-ss",t)}};function X(a,t){return new J(a,t)}/**
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 */class Z{onMessage(t,e){const s=$(".box-window").filter(`[data-topic="${e.destinationName}"]`);s&&e.payloadBytes[0]!==0?s.addClass("open"):s.removeClass("open")}}function tt(a,t){return new Z}/**
 * @copyright Chaos Computer Club Cologne 2014-2020
 * @license MIT
 * @requires utils
 */$(()=>{fetch("./config.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(a=>a.json()).then(a=>{var t;(t=a.debug)!=null&&t.configLoaded&&console.debug("Config loaded successfully",a),globalThis.autoc4=new et(a)}).catch(a=>{console.error("Couldn't load config.json",a)})});class et{constructor(t){u(this,"config");u(this,"modules",[]);u(this,"client");u(this,"_moduleTypes",{});this.config=t,this.client=new Paho.MQTT.Client(t.server||window.location.hostname,t.port||9e3,(t.clientIdPrefix||"shiny_")+K()),this.client.onMessageArrived=this.onMessage.bind(this),this.client.onConnectionLost=this.onConnectionFailure.bind(this),this.registerModuleType("interactivity",L),this.registerModuleType("light",U),this.registerModuleType("dmx",D),this.registerModuleType("state",W),this.registerModuleType("heartbeat",T),this.registerModuleType("windows",tt),this.registerModuleType("presets",j),this.registerModuleType("kitchenlight",B),this.registerModuleType("music",H),this.registerModuleType("notify",q),this.registerModuleType("time",X),this.registerModuleType("cyber",C),this.loadModules(),this.connect()}loadModules(){var t;for(const e of this.config.modules)try{e.instance=this.moduleConfigToModule(e),this.modules.push(e.instance),(t=this.config.debug)!=null&&t.moduleLoaded&&console.debug(`Successfully initialized module of type "${e.type}".`,e)}catch(s){console.error("An error occured while initializing a module."),console.error("Module Type: ",e.type),console.error(s)}}connect(){this.client.connect({onSuccess:this.onConnect.bind(this),onFailure:this.client.onConnectionLost,mqttVersion:3})}onMessage(t){var e,s,o,n;(e=this.config.debug)!=null&&e.message&&console.debug("MQTT message received:",t);for(const i of this.config.modules)try{(s=i.subscribe)!=null&&s.some(r=>z(r,t.destinationName))&&((n=(o=i.instance).onMessage)==null||n.call(o,this,t))}catch(r){console.error("An error occured while processing a message."),console.error("Module: ",i.instance),console.error(r)}}onConnect(t){var e,s;(e=this.config.debug)!=null&&e.connect&&console.debug("MQTT connection successfull.",t);for(const o of this.config.modules)if(o.subscribe)for(const n of o.subscribe)this.client.subscribe(n);for(const o of this.modules)try{(s=o.onConnect)==null||s.call(o,this,t)}catch(n){console.error("An error occured while handling disconnect."),console.error("Module: ",o),console.error(n)}}onConnectionFailure(t){var e,s;(e=this.config.debug)!=null&&e.disconnect&&console.warn("MQTT connection failure, retrying in 5 seconds..",t),setTimeout(o=>{o.connect()},5e3,this);for(const o of this.modules)try{(s=o.onConnectionFailure)==null||s.call(o,this,t)}catch(n){console.error("An error occured while handling disconnect."),console.error("Module: ",o),console.error(n)}}sendData(t,e,s=!1){var n;const o=new Paho.MQTT.Message(e);o.destinationName=t,o.retained=s,this.client.send(o),(n=this.config.debug)!=null&&n.sentMessage&&console.debug("Sent MQTT Message:",o)}sendByte(t,e,s=!1){this.sendData(t,new Uint8Array(e===void 0?[0]:[e]),s)}registerModuleType(t,e){this._moduleTypes[t]=e}moduleConfigToModule(t){if(t.type in this._moduleTypes)return this._moduleTypes[t.type](this,t.options);throw new Error(`Unknown module type: ${t.type}`)}}
